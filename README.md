# discord-webhook-notifier\n\nA small Python tool for sending templated Discord webhook messages from the command line or a lightweight Tk GUI. Templates are written in Jinja2 and render to Discord-compatible JSON payloads, enabling reusable announcement layouts.\n\n## Features\n\n- Load defaults from `.env` files via `python-dotenv`, with CLI overrides.\n- Render Jinja2 JSON templates with runtime variables, timestamps, and `.env` values.\n- Support `@everyone` toggles, attachment uploads, and webhook redaction in logs.\n- Gracefully handle Discord rate limits with a single automatic retry.\n- Thin Tk GUI that shells out to the CLI for identical behaviour, with persisted form state.\n\n## Getting Started\n\n```bash\npython3 -m venv .venv\nsource .venv/bin/activate\npip install --upgrade pip\npip install -e .[dev]\n```\n\nCopy `.env.example` to `.env` and populate it with your Discord webhook URL and defaults.\n\n## CLI Usage\n\n```bash\npython3 -m src.main \\\n  --template templates/live_announcement.json.j2 \\\n  --message \"Stream is up: spooky speedruns!\" \\\n  --everyone \\\n  --var title=\"Halloween Marathon\" \\\n  --var stream_url=\"https://twitch.tv/FoxyLupi\"\n```\n\nKey options:\n\n- `--file PATH` to attach files referenced via `attachment://` in templates.\n- `--dry-run` to render and print the payload without sending.\n- `--allow-mentions everyone,roles` to control mention behaviour.\n- `--no-retry` to disable the automatic rate-limit retry.\n\nExit codes: `0` success, `2` validation error, `3` HTTP error, `4` rate-limit exhausted, `5` template error.\n\n## GUI Frontend\n\nLaunch the GUI with:\n\n```bash\npython3 -m src.notifier.gui_tk\n```\n\nThe GUI mirrors the CLI: fill in your webhook, template, message, variables (one per line as `key=value`), and optional attachments. \"Preview\" runs the CLI with `--dry-run` and shows the JSON/log output, while \"Send\" executes the CLI normally. Recent settings persist in `~/.discord-webhook-notifier/state.json`.\n\n## Development & Testing\n\nRun linters/tests from the project root:\n\n```bash\npytest\n```\n\nTests cover template rendering, payload validation, and the CLI dry-run path. When adding new features, prefer fast unit tests and rely on `pytest-httpserver` for HTTP interactions.\n\n---\n\nLicense: GPL-3.0-or-later\n*** End Patch
